<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Tagesliste</title>
    <style>
        @page { margin:0; }
        body {
            font-family:arial,sans-serif;
            font-size:15px;
            margin-bottom: 0;
            margin-top: 0px;
            margin-left: 0px;
        }

        #page_1 {position:relative; overflow: hidden;padding: 0px;border: none;height: 781px;}
        #page_1 #id_1 {border:none;padding: 0px;border:none;overflow: hidden;}
        #page_1 #id_2 {border:none;margin: 57px 0px 0px 121px;padding: 0px;border:none;overflow: hidden;}

        #page_1 #p1dimg1 {position:absolute;top:732px;left:0px;z-index:-1;height:49px;}
        #page_1 #p1dimg1 #p1img1 {height:49px;}




        .ft0{font: bold 12px 'Segoe UI';line-height: 15px;}
        .ft1{font: bold 20px 'Segoe UI Semibold';color: #98ce16;line-height: 28px;}
        .ft2{font: 1px 'Segoe UI';line-height: 1px;}
        .ft3{font: bold 13px 'Segoe UI';color: #ffffff;line-height: 17px;}
        .ft4{font: 13px 'Segoe UI';line-height: 17px;}
        .ft5{font: 13px 'Segoe UI';color: #fc0011;line-height: 17px;}
        .ft6{font: bold 13px 'Segoe UI';line-height: 17px;}
        .ft7{font: bold 11px 'Segoe UI';color: #ffffff;line-height: 13px;}
        .ft8{font: 9px 'Segoe UI Symbol';color: #ffffff;line-height: 12px;}
        .ft9{font: 11px 'Segoe UI Symbol';color: #ffffff;line-height: 13px;}
        .ft10{font: 11px 'Segoe UI';color: #ffffff;line-height: 13px;}

        .p0{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p1{text-align: right;padding-right: 15px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p2{text-align: left;padding-left: 7px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p3{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p4{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p5{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p6{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p7{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p8{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p9{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p10{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p11{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p12{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p13{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p14{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p15{text-align: left;padding-left: 5px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}
        .p16{text-align: left;margin-top: 0px;margin-bottom: 0px;}

        .td0{padding: 0px;margin: 0px;vertical-align: bottom;}
        .td1{padding: 0px;margin: 0px;vertical-align: bottom;}
        .td2{padding: 0px;margin: 0px;vertical-align: bottom;}
        .td3{padding: 0px;margin: 0px;vertical-align: bottom;}
        .td4{padding: 0px;margin: 0px;vertical-align: bottom;}
        .td5{padding: 0px;margin: 0px;vertical-align: bottom;}
        .td6{padding: 0px;margin: 0px;vertical-align: bottom;}
        .td7{padding: 0px;margin: 0px;vertical-align: bottom;background: #8cc818;}
        .td8{padding: 0px;margin: 0px;vertical-align: bottom;background: #8cc818;}
        .td9{padding: 0px;margin: 0px;vertical-align: bottom;background: #8cc818;}
        .td10{padding: 0px;margin: 0px;vertical-align: bottom;background: #8cc818;}
        .td11{padding: 0px;margin: 0px;vertical-align: bottom;background: #8cc818;}
        .td12{padding: 0px;margin: 0px;vertical-align: bottom;background: #8cc818;}
        .td13{padding: 0px;margin: 0px;vertical-align: bottom;background: #8cc818;}
        .td14{padding: 0px;margin: 0px;vertical-align: bottom;background: #8cc818;}
        .td15{padding: 0px;margin: 0px;vertical-align: bottom;background: #8cc818;}
        .td16{padding: 0px;margin: 0px;vertical-align: bottom;background: #e6e6e6;}
        .td17{padding: 0px;margin: 0px;vertical-align: bottom;background: #e6e6e6;}
        .td18{padding: 0px;margin: 0px;vertical-align: bottom;background: #e6e6e6;}
        .td19{padding: 0px;margin: 0px;vertical-align: bottom;background: #e6e6e6;}
        .td20{padding: 0px;margin: 0px;vertical-align: bottom;background: #e6e6e6;}
        .td21{padding: 0px;margin: 0px;vertical-align: bottom;background: #e6e6e6;}
        .td22{padding: 0px;margin: 0px;vertical-align: bottom;background: #e6e6e6;}
        .td23{padding: 0px;margin: 0px;vertical-align: bottom;background: #e6e6e6;}
        .td24{padding: 0px;margin: 0px;vertical-align: bottom;background: #e6e6e6;}
        .td25{padding: 0px;margin: 0px;vertical-align: bottom;background: #e6e6e6;}
        .td26{padding: 0px;margin: 0px;vertical-align: bottom;background: #cccccc;}
        .td27{padding: 0px;margin: 0px;vertical-align: bottom;background: #cccccc;}
        .td28{padding: 0px;margin: 0px;vertical-align: bottom;background: #cccccc;}
        .td29{padding: 0px;margin: 0px;vertical-align: bottom;background: #cccccc;}
        .td30{padding: 0px;margin: 0px;vertical-align: bottom;background: #cccccc;}
        .td31{padding: 0px;margin: 0px;vertical-align: bottom;background: #cccccc;}
        .td32{padding: 0px;margin: 0px;vertical-align: bottom;background: #cccccc;}
        .td33{padding: 0px;margin: 0px;vertical-align: bottom;background: #cccccc;}
        .td34{padding: 0px;margin: 0px;vertical-align: bottom;background: #cccccc;}
        .td35{padding: 0px;margin: 0px;vertical-align: bottom;background: #cccccc;}
        .td36{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;vertical-align: bottom;}
        .td37{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;vertical-align: bottom;}
        .td38{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;vertical-align: bottom;}
        .td39{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;vertical-align: bottom;}
        .td40{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;vertical-align: bottom;}
        .td41{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;vertical-align: bottom;}
        .td42{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;vertical-align: bottom;}
        .td43{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;vertical-align: bottom;}
        .td44{padding: 0px;margin: 0px;vertical-align: bottom;}
        .td45{padding: 0px;margin: 0px;vertical-align: bottom;}
        .td46{border-bottom: #000000 1px solid;padding: 0px;margin: 0px;vertical-align: bottom;}
        .td47{padding: 0px;margin: 0px;vertical-align: bottom;}
        .td48{padding: 0px;margin: 0px;vertical-align: bottom;background: #33b1d2;}
        .td49{padding: 0px;margin: 0px;vertical-align: bottom;background: #33b1d2;}
        .td50{padding: 0px;margin: 0px;vertical-align: bottom;background: #33b1d2;}
        .td51{padding: 0px;margin: 0px;vertical-align: bottom;background: #33b1d2;}
        .td52{padding: 0px;margin: 0px;vertical-align: bottom;background: #33b1d2;}
        .td53{padding: 0px;margin: 0px;vertical-align: bottom;background: #33b1d2;}
        .td54{padding: 0px;margin: 0px;vertical-align: bottom;background: #33b1d2;}
        .td55{padding: 0px;margin: 0px;vertical-align: bottom;background: #33b1d2;}
        .td56{padding: 0px;margin: 0px;vertical-align: bottom;background: #33b1d2;}

        .tr0{height: 43px;}
        .tr1{height: 20px;}
        .tr2{height: 17px;}
        .tr3{height: 21px;}
        .tr4{height: 18px;}
        .tr5{height: 27px;}
        .tr6{height: 39px;}
        .tr7{height: 28px;}
        .tr8{height: 40px;}

        .t0{font: 13px 'Segoe UI';}

        .page-break {
            page-break-after: always;
        }
    </STYLE>

</head>
<body>
<div class="page-break">
<TABLE style="padding:10px 30px;width:100%;font-family:arial,sans-serif;font-size:13px;border-collapse:collapse;">
    <TR>
        <TD colspan=2 class="tr0 td0"><P class="p0 ft1">{{ $cabinname }} <NOBR><SPAN class="ft0">{{--{{ $invoice_code }}--}}</SPAN></NOBR></P></TD>
        <TD class="tr0 td1"><P class="p0 ft2">&nbsp;</P></TD>
        <TD class="tr0 td2"><P class="p0 ft2">&nbsp;</P></TD>
        <TD class="tr0 td3"><P class="p0 ft2">&nbsp;</P></TD>
        @if(isset($cabinHalfboard) && $cabinHalfboard === '1')
            <TD class="tr0 td4"><P class="p0 ft2">&nbsp;</P></TD>
        @endif
        <TD class="tr0 td5"><P class="p0 ft2">&nbsp;</P></TD>
        <TD colspan=2 class="tr0 td6"><P class="p1 ft0">Anreisetag - Buchungsübersicht vom {{date('d.m')}}</P></TD>
    </TR>

    @inject('cronServices', 'App\Http\Controllers\CronJobsController')

    <TR>
        <TD class="tr1 td7"><P class="p2 ft3">Buchungsnr.:</P></TD>
        <TD class="tr1 td8"><P class="p0 ft3">Name</P></TD>
        <TD class="tr1 td9"><P class="p0 ft3">Datum</P></TD>
        <TD class="tr1 td10"><P class="p0 ft3">Nächte</P></TD>
        <TD class="tr1 td11"><P class="p3 ft3">Anzahl P.</P></TD>
        <TD class="tr1 td12"><P class="p4 ft3">Schlafplätze</P></TD>
        @if(isset($cabinHalfboard) && $cabinHalfboard === '1')
            <TD class="tr1 td13"><P class="p5 ft3">Halbpension</P></TD>
        @endif
        <TD class="tr1 td14"><P class="p0 ft3">Gutscheinwert</P></TD>
        <TD class="tr1 td15"><P class="p6 ft3">Kontakt</P></TD>
    </TR>

    @if(isset($bookings))
        @forelse($bookings as $booking)
            @php
                if(!empty($booking->temp_user_id)){
                    $userDetails = $cronServices->tempUser($booking->temp_user_id);
                    if(!empty($userDetails))
                    {
                      $firstName = $userDetails->usrFirstname;
                      $lastName  = $userDetails->usrLastname;
                      $email     = $userDetails->usrEmail;
                      $phone     = $userDetails->usrTelephone;
                    }

                }
                else {
                      $userDetails = $cronServices->user($booking->user);

                      if(!empty($userDetails))
                      {
                        $firstName = $userDetails->usrFirstname;
                        $lastName  = $userDetails->usrLastname;
                        $email     = $userDetails->usrEmail;
                        $phone     = $userDetails->usrTelephone;
                      }
                }

                /* Checking condition for date */
                if(!empty($booking->checkin_from) && !empty($booking->reserve_to)) {
                    $daysDifference = round(abs(strtotime(date_format($booking->checkin_from, 'd.m.Y')) - strtotime(date_format($booking->reserve_to, 'd.m.Y'))) / 86400);
                }
                else {
                    $daysDifference = 'Date not set';
                }

                /* Checking halfboard available or not */
                if(!empty($booking->halfboard)) {
                    $halfboard = $booking->halfboard;
                }
                else {
                    $halfboard = 'ohne';
                }

                /* Listing beds dorms separately */
                if($sleepingPlace != 1) {
                   $category = $booking->beds .'B '. $booking->dormitory .'M';
                }
                else {
                   $category = $booking->sleeps;
                }

            @endphp

            <TR class="page-break">
                <TD class="tr2 td16"><P class="p2 ft4">{{ $booking->invoice_number }}</P></TD>
                <TD class="tr2 td17"><P class="p7 ft4">{{ $firstName}} {{ $lastName }}</P></TD>
                <TD class="tr2 td18"><P class="p8 ft4">{{ $booking->checkin_from->format('d.m') }} bis {{ $booking->reserve_to->format('d.m') }}</P></TD>
                <TD class="tr2 td19"><P class="p9 ft4">{{ $daysDifference }}</P></TD>
                <TD class="tr2 td20"><P class="p10 ft4">{{ $booking->guests }}</P></TD>
                <TD class="tr2 td21"><P class="p11 ft4">{{ $category }}</P></TD>
                @if(isset($cabinHalfboard) && $cabinHalfboard === '1')
                    <TD class="tr2 td22"><P class="p12 ft4"></P>{{ $halfboard }}</TD>
                @endif
                <TD class="tr2 td23"><P class="p13 ft4">{{ number_format($booking->prepayment_amount, 2, ',', '.') }} &euro;</P></TD>
                <TD class="tr2 td24"><P class="p14 ft4">{{ $email }}</P></TD>
            </TR>
            <TR>
                <TD colspan=7 class="tr3 td25"><P class="p2 ft5">{{ $booking->comments }}</P></TD>
                @if(isset($cabinHalfboard) && $cabinHalfboard === '1')
                    <TD class="tr3 td23"><P class="p0 ft2">&nbsp;</P></TD>
                @endif
                <TD class="tr3 td24"><P class="p15 ft4">{{ $phone }}</P></TD>
            </TR>

        @empty
            <TR>
                <TD colspan=7 class="tr3 td25"><P class="p2 ft5">&nbsp;</P></TD>
                <TD class="tr3 td23"><P class="p0 ft2">Keine Buchung</P></TD>
                <TD class="tr3 td24"><P class="p15 ft4">&nbsp;</P></TD>
            </TR>
        @endforelse

            <TR>
                <TD class="tr5 td36"><P class="p0 ft2">&nbsp;</P></TD>
                <TD class="tr5 td37"><P class="p0 ft2">&nbsp;</P></TD>
                <TD class="tr5 td38"><P class="p0 ft2">&nbsp;</P></TD>
                <TD class="tr5 td39"><P class="p0 ft2">&nbsp;</P></TD>
                <TD class="tr5 td40"><P class="p0 ft2">&nbsp;</P></TD>
                @if(isset($cabinHalfboard) && $cabinHalfboard === '1')
                    <TD class="tr5 td41"><P class="p0 ft2">&nbsp;</P></TD>
                @endif
                <TD class="tr5 td42"><P class="p0 ft2">&nbsp;</P></TD>
                <TD colspan=2 class="tr5 td43"><P class="p0 ft2">&nbsp;</P></TD>
            </TR>

    @endif

    <TR>
        <TD class="tr6 td44"><P class="p0 ft2">&nbsp;</P></TD>
        <TD class="tr6 td45"><P class="p0 ft2">&nbsp;</P></TD>
        <TD class="tr6 td1"><P class="p0 ft2">&nbsp;</P></TD>
        <TD class="tr6 td2"><P class="p0 ft2">&nbsp;</P></TD>
        <TD class="tr6 td3"><P class="p0 ft2">&nbsp;</P></TD>
        @if(isset($cabinHalfboard) && $cabinHalfboard === '1')
            <TD class="tr6 td4"><P class="p0 ft2">&nbsp;</P></TD>
        @endif
        <TD class="tr6 td5"><P class="p0 ft2">&nbsp;</P></TD>
        <TD colspan=2 class="tr6 td6"><P class="p1 ft0">Anreisetag - <NOBR>Bergschulenübersicht</NOBR> vom {{date('d.m')}}</P></TD>
    </TR>
    <TR>
        <TD class="tr1 td7"><P class="p2 ft3">Buchungsnr.:</P></TD>
        <TD class="tr1 td8"><P class="p0 ft3">Name</P></TD>
        <TD class="tr1 td9"><P class="p0 ft3">Datum</P></TD>
        <TD class="tr1 td10"><P class="p0 ft3">Nächte</P></TD>
        <TD class="tr1 td11"><P class="p3 ft3">Anzahl P.</P></TD>
        <TD class="tr1 td12"><P class="p4 ft3">Schlafplätze</P></TD>
        @if(isset($cabinHalfboard) && $cabinHalfboard === '1')
            <TD class="tr1 td13"><P class="p5 ft3">Halbpension</P></TD>
        @endif
        <TD class="tr1 td14"><P class="p0 ft3">Gutscheinwert</P></TD>
        <TD class="tr1 td15"><P class="p6 ft3">Kontakt</P></TD>
    </TR>

    @if(isset($msBookings))
        @forelse($msBookings as $msBooking)
            @php
                $userDetails = $cronServices->user($msBooking->user_id);

                if(!empty($userDetails))
                {
                  $firstName = $userDetails->usrFirstname;
                  $lastName  = $userDetails->usrLastname;
                  $email     = $userDetails->usrEmail;
                  $phone     = $userDetails->usrTelephone;
                }

                if(!empty($msBooking->check_in) && !empty($msBooking->reserve_to)) {
                    $daysDifference = round(abs(strtotime(date_format($msBooking->check_in, 'd.m.Y')) - strtotime(date_format($msBooking->reserve_to, 'd.m.Y'))) / 86400);
                }
                else {
                    $daysDifference = 'Date not set';
                }

                /* Checking halfboard available or not */
                if(!empty($msBooking->half_board)) {
                    $msHalfboard = $msBooking->half_board;
                }
                else {
                    $msHalfboard = 'ohne';
                }

                /* Listing beds dorms separately */
                if($sleepingPlace != 1) {
                   $msCategory = $msBooking->beds .'B '. $msBooking->dormitory .'M';
                }
                else {
                   $msCategory = $msBooking->sleeps;
                }
            @endphp
            <TR class="page-break">
                <TD class="tr2 td16"><P class="p2 ft4">{{ $msBooking->invoice_number }}</P></TD>
                <TD class="tr2 td17"><P class="p7 ft4">{{ $firstName }} {{ $lastName }}</P></TD>
                <TD class="tr2 td18"><P class="p8 ft4">{{ $msBooking->check_in->format('d.m') }} bis {{ $msBooking->reserve_to->format('d.m') }}</P></TD>
                <TD class="tr2 td19"><P class="p9 ft4">{{ $daysDifference }}</P></TD>
                <TD class="tr2 td20"><P class="p10 ft4">{{ $msBooking->guests }}</P></TD>
                <TD class="tr2 td21"><P class="p11 ft4">{{ $msCategory }}</P></TD>
                @if(isset($cabinHalfboard) && $cabinHalfboard === '1')
                    <TD class="tr2 td22"><P class="p12 ft4">{{ $msHalfboard }}</P></TD>
                @endif
                <TD class="tr2 td23"><P class="p13 ft4">Null</P></TD>
                <TD class="tr2 td24"><P class="p14 ft4">{{ $email }}</P></TD>
            </TR>
            <TR>
                <TD colspan=7 class="tr3 td25"><P class="p2 ft5">&nbsp;</P></TD>
                @if(isset($cabinHalfboard) && $cabinHalfboard === '1')
                    <TD class="tr3 td23"><P class="p0 ft2">&nbsp;</P></TD>
                @endif
                <TD class="tr3 td24"><P class="p15 ft4">{{ $phone }}</P></TD>
            </TR>
        @empty
            <TR>
                <TD colspan=7 class="tr3 td35"><P class="p2 ft5">&nbsp;</P></TD>
                <TD class="tr3 td33"><P class="p0 ft2">Keine Buchung</P></TD>
                <TD class="tr3 td34"><P class="p15 ft4">&nbsp;</P></TD>
            </TR>
        @endforelse
            <TR>
                <TD class="tr7 td36"><P class="p0 ft2">&nbsp;</P></TD>
                <TD class="tr7 td37"><P class="p0 ft2">&nbsp;</P></TD>
                <TD class="tr7 td38"><P class="p0 ft2">&nbsp;</P></TD>
                <TD class="tr7 td39"><P class="p0 ft2">&nbsp;</P></TD>
                @if(isset($cabinHalfboard) && $cabinHalfboard === '1')
                    <TD class="tr7 td40"><P class="p0 ft2">&nbsp;</P></TD>
                @endif
                <TD class="tr7 td41"><P class="p0 ft2">&nbsp;</P></TD>
                <TD colspan=3 class="tr7 td46"><P class="p0 ft2">&nbsp;</P></TD>
            </TR>
    @endif
</TABLE>
</div>
</body>
</html>
