$(function(){$(".filterCheckbox").prop("checked",!1);var e=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.value)},queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:{url:"/",transform:function(e){return $.map(e,function(e){return{value:e.name}})}},remote:{wildcard:"%QUERY",url:"search/cabin/%QUERY",transform:function(e){return $.map(e,function(e){return{value:e.name}})}}});$("#prefetch .typeahead").typeahead({hint:!1,highlight:!0,minLength:2,limit:10},{name:"Cabins",display:"value",source:e})}),$(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("body").on("mousedown",".dateFrom",function(){var e=$(this).parent().parent().data("id"),t=$("#dateFrom_"+e),a=[],o=$(".holiday_"+e).data("holiday"),n=$(".green_"+e).data("green"),r=$(".orange_"+e).data("orange"),i=$(".red_"+e).data("red"),s=$(".notSeasonTime_"+e).data("notseasontime"),l="";t.datepicker({showAnim:"drop",dateFormat:"dd.mm.y",changeMonth:!0,changeYear:!0,monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],minDate:"+1d",yearRange:"0:+2"}),t.datepicker("option","onSelect",function(a){var o=$("#dateTo_"+e),n=t.datepicker("getDate"),r=t.datepicker("getDate");o.datepicker("setDate",r),n.setDate(n.getDate()+60),r.setDate(r.getDate()+1),o.datepicker("option","maxDate",n),o.datepicker("option","minDate",r)}),t.datepicker("option","onChangeMonthYear",function(a,d,c){void 0!=a&&void 0!=d&&(l=a+"-",l+=d+"-",l+="01"),$.ajax({url:"/calendar/ajax",dataType:"JSON",type:"POST",data:{dateFrom:l,dataId:e},success:function(e){for(var a=0;a<e.holidayDates.length;a++)o.push(e.holidayDates[a]);for(var a=0;a<e.greenDates.length;a++)n.push(e.greenDates[a]);for(var a=0;a<e.orangeDates.length;a++)r.push(e.orangeDates[a]);for(var a=0;a<e.redDates.length;a++)i.push(e.redDates[a]);for(var a=0;a<e.not_season_time.length;a++)s.push(e.not_season_time[a]);t.datepicker("refresh")}})}),t.datepicker("option","beforeShowDay",function(e){var t=jQuery.datepicker.formatDate("yy-mm-dd",e);return n.indexOf(t)>=0&&(a=[!0,"greenDates","Verfügbar"]),r.indexOf(t)>=0&&(a=[!0,"orangeDates","Begrenzt"]),i.indexOf(t)>=0&&(a=[!0,"redDates","Ausgebucht"]),s.indexOf(t)>=0&&(a=[!1,"","Geschlossen"]),o.indexOf(t)>=0&&(a=[!1,"","Ruhetag"]),a}),t.datepicker("show")}),$("body").on("mousedown",".dateTo",function(){var e=$(this).parent().parent().data("id"),t=$("#dateTo_"+e),a=[],o=$(".holiday_"+e).data("holiday"),n=$(".green_"+e).data("green"),r=$(".orange_"+e).data("orange"),i=$(".red_"+e).data("red"),s=$(".notSeasonTime_"+e).data("notseasontime"),l="";t.datepicker({showAnim:"drop",dateFormat:"dd.mm.y",changeMonth:!0,changeYear:!0,monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],yearRange:"0:+2"}),t.datepicker("option","onChangeMonthYear",function(a,d,c){void 0!=a&&void 0!=d&&(l=a+"-",l+=d+"-",l+="01"),$.ajax({url:"/calendar/ajax",dataType:"JSON",type:"POST",data:{dateFrom:l,dataId:e},success:function(e){for(var a=0;a<e.holidayDates.length;a++)o.push(e.holidayDates[a]);for(var a=0;a<e.greenDates.length;a++)n.push(e.greenDates[a]);for(var a=0;a<e.orangeDates.length;a++)r.push(e.orangeDates[a]);for(var a=0;a<e.redDates.length;a++)i.push(e.redDates[a]);for(var a=0;a<e.not_season_time.length;a++)s.push(e.not_season_time[a]);t.datepicker("refresh")}})}),t.datepicker("option","beforeShowDay",function(e){var t=jQuery.datepicker.formatDate("yy-mm-dd",e);return n.indexOf(t)>=0&&(a=[!0,"greenDates","Verfügbar"]),r.indexOf(t)>=0&&(a=[!0,"orangeDates","Begrenzt"]),i.indexOf(t)>=0&&(a=[!0,"redDates","Ausgebucht"]),o.indexOf(t)>=0&&(a=[!0,"holidayDates","Ruhetag"]),s.indexOf(t)>=0&&(a=[!1,"","Geschlossen"]),a}),t.datepicker("show")})}),$(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});$(".cabinListMore").each(function(){var e=$(this).html();if(e&&e.length>375){var t=e.substr(0,375),a=e.substr(375,e.length-375),o=t+'<span class="cabinListMoreEllipses">...&nbsp;</span><span class="cabinListMoreContent"><span>'+a+"</span>&nbsp;&nbsp;</span>";$(this).html(o)}}),$("body").on("click",".addToCart",function(e){e.preventDefault();var t=$(this).parent().parent().data("cab"),a=$("#dateFrom_"+t).val(),o=$("#dateTo_"+t).val(),n=$("#beds_"+t).val(),r=$("#dorms_"+t).val(),i=$("#sleeps_"+t).val(),s=$("#sleeping_place_"+t).val(),l=$(this).val(),d="";$.ajax({url:"/add/to/cart",dataType:"JSON",type:"POST",data:{dateFrom:a,dateTo:o,beds:n,dorms:r,sleeps:i,addToCart:l,cabin:t,sleeping_place:s}}).done(function(e){if("success"===e.response){$("#errors_"+t).hide(),$("#warning_"+t).hide(),window.location.href="/cart"}}).fail(function(e,a,o,n){if(422===e.status){var r=e.responseJSON.errors;if(r)$("#warning_"+t).hide(),$("#errors_"+t).show(),d='<div class="alert alert-danger"><ul>',$.each(r,function(e,t){d+="<li>"+t+"</li>"}),d+="</ul></div>",$("#errors_"+t).html(d);else{$("#errors_"+t).hide(),$("#warning_"+t).show();var i=e.responseJSON;d='<div class="alert alert-info"><ul>',$.each(i,function(e,t){d+="<li>"+t+"</li>"}),d+="</ul></div>",$("#warning_"+t).html(d)}}})}),$("body").on("click",".cookieToCart",function(e){e.preventDefault();var t=$(this).val(),a=$(this).parent().parent().data("cab"),o=$("#dateFrom_"+a).val(),n=$("#dateTo_"+a).val(),r=$("#beds_"+a).val(),i=$("#dorms_"+a).val(),s=$("#sleeps_"+a).val(),l=$("#sleeping_place_"+a).val(),d="";$.ajax({url:"/session/data/to/cart",dataType:"JSON",type:"POST",data:{dateFrom:o,dateTo:n,beds:r,dorms:i,sleeps:s,cookieToCart:t,cabin:a,sleeping_place:l}}).done(function(e){if("success"===e.response){$("#errors_"+a).hide(),$("#warning_"+a).hide(),window.location.href="/login"}}).fail(function(e,t,o,n){if(422===e.status){var r=e.responseJSON.errors;if(r)$("#warning_"+a).hide(),$("#errors_"+a).show(),d='<div class="alert alert-danger"><ul>',$.each(r,function(e,t){d+="<li>"+t+"</li>"}),d+="</ul></div>",$("#errors_"+a).html(d);else{$("#errors_"+a).hide(),$("#warning_"+a).show();var i=e.responseJSON;d='<div class="alert alert-info"><ul>',$.each(i,function(e,t){d+="<li>"+t+"</li>"}),d+="</ul></div>",$("#warning_"+a).html(d)}}})})}),$(function(){$(".toggleSeasonTime").on("click",function(){$(".seasonTimes").toggle(500)});var e=$(".more").html();if(e&&e.length>375){var t=e.substr(0,375),a=e.substr(375,e.length-375),o=t+'<span class="moreellipses">...&nbsp;</span><span class="morecontent"><span>'+a+'</span><button class="btn btn-default btn-sm btn-details morelink">Mehr anzeigen</button></span>';$(".more").html(o)}$(".morelink").click(function(){return $(this).hasClass("less")?($(this).removeClass("less"),$(this).html("Mehr anzeigen")):($(this).addClass("less"),$(this).html("Weniger anzeigen")),$(this).parent().prev().toggle(),$(this).prev().toggle(),!1}),$('[data-toggle="tooltip"]').tooltip(),$("#image-gallery").lightSlider({gallery:!0,item:1,thumbItem:9,slideMargin:0,speed:700,auto:!0,loop:!0,onSliderLoad:function(){$("#image-gallery").removeClass("cS-hidden")}})}),$(function(){function e(){var e={tax_one:window.environment.service_tax_one,tax_two:window.environment.service_tax_two,tax_three:window.environment.service_tax_three},t="",o=0;$("p.bookingDeposit").each(function(){o+=Number($(this).text().replace(/[^0-9\.-]+/g,""))});var n=o.toString(),r=n.substring(0,n.length-2)+"."+n.substring(n.length-2),i=a.format(Number(r));Number(r)<=30&&(t=e.tax_one),Number(r)>30&&Number(r)<=100&&(t=e.tax_two),Number(r)>100&&(t=e.tax_three);var s=t/100*Number(r),l=Number(r)+s;$(".replaceBookingCompleteDeposit").html(i),$(".replaceBookingServiceFee").html(t+" %"),$(".replaceBookingCompletePayment").html(a.format(l))}if($.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(".forComments").length>0){var t=$(".forComments").map(function(){return $(this).data("cartid")}).get();$.each(t,function(e,t){$("#textarea_feedback_"+t).css("color","red"),$("#textarea_feedback_"+t).html("noch 300 Zeichen"),$("#comments_"+t).keyup(function(){var e=$("#comments_"+t).val().length,a=300-e;$("#textarea_feedback_"+t).html("noch "+a+" Zeichen")})})}var a=new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",minimumFractionDigits:2});$(".jsBookCalSleep").change(function(){var t=$(this).parent().parent().data("cartid"),o=0,n=$(".amountBookingDays_"+t).data("amountbookingdays");""!==$(this).val()&&(o=$(this).val());var r=n*o;$(".replaceBookingGuest_"+t).html(o),$(".replaceBookingDeposit_"+t).html(a.format(r)),e()}),$(".jsBookCalBeds").change(function(){var t=$(this).parent().parent().data("cartid"),o=0,n=0,r=$(".amountBookingDays_"+t).data("amountbookingdays");""!==$(this).val()&&(o=$(this).val()),""!==$(this).closest("div").next("div").find("select").val()&&(n=$(this).closest("div").next("div").find("select").val());var i=parseInt(o)+parseInt(n),s=i*r;$(".replaceBookingGuest_"+t).html(i),$(".replaceBookingDeposit_"+t).html(a.format(s)),e()}),$(".jsBookCalDormitory").change(function(){var t=$(this).parent().parent().data("cartid"),o=0,n=0,r=$(".amountBookingDays_"+t).data("amountbookingdays");""!==$(this).val()&&(o=$(this).val()),""!==$(this).closest("div").prev("div").find("select").val()&&(n=$(this).closest("div").prev("div").find("select").val());var i=parseInt(o)+parseInt(n),s=i*r;$(".replaceBookingGuest_"+t).html(i),$(".replaceBookingDeposit_"+t).html(a.format(s)),e()})}),$(function(){function e(e){var a={tax_one:window.environment.service_tax_one,tax_two:window.environment.service_tax_two,tax_three:window.environment.service_tax_three},o="";e<=30&&(o=a.tax_one),e>30&&e<=100&&(o=a.tax_two),e>100&&(o=a.tax_three);var n=o/100*e,r=e+n;$(".replaceInquiryCompleteDeposit").html(t.format(e)),$(".replaceInquiryServiceFee").html(o+" %"),$(".replaceInquiryCompletePayment").html(t.format(r))}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});$("#textarea_feedback").css("color","red"),$("#textarea_feedback").html("noch 300 Zeichen"),$("#comments").keyup(function(){var e=$("#comments").val().length,t=300-e;$("#textarea_feedback").html("noch "+t+" Zeichen")});var t=new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",minimumFractionDigits:2});$(".jsCalSleep").change(function(){var a=$(".amountDays").data("amountdays"),o=0;""!==$(this).val()&&(o=$(this).val());var n=a*o;$(".replaceInquiryGuest").html(o),$(".replaceInquiryDeposit").html(t.format(n)),e(n)}),$(".jsCalBed").change(function(){var a=$(".amountDays").data("amountdays"),o=0,n=0;""!==$(this).val()&&(n=$(this).val()),""!==$(".jsCalDorm").val()&&(o=$(".jsCalDorm").val());var r=parseInt(n)+parseInt(o),i=(parseInt(n)+parseInt(o))*a;$(".replaceInquiryGuest").html(r),$(".replaceInquiryDeposit").html(t.format(i)),e(i)}),$(".jsCalDorm").change(function(){var a=$(".amountDays").data("amountdays"),o=0,n=0;""!==$(this).val()&&(o=$(this).val()),""!==$(".jsCalBed").val()&&(n=$(".jsCalBed").val());var r=parseInt(o)+parseInt(n),i=(parseInt(o)+parseInt(n))*a;$(".replaceInquiryGuest").html(r),$(".replaceInquiryDeposit").html(t.format(i)),e(i)})}),$(function(){function e(){return{tax_one:window.environment.service_tax_one,tax_two:window.environment.service_tax_two,tax_three:window.environment.service_tax_three,service_tax_paybybill_one:window.environment.service_tax_paybybill_one,service_tax_paybybill_two:window.environment.service_tax_paybybill_two,service_tax_paybybill_three:window.environment.service_tax_paybybill_three,service_tax_sofort_one:window.environment.service_tax_sofort_one,service_tax_sofort_two:window.environment.service_tax_sofort_two,service_tax_sofort_three:window.environment.service_tax_sofort_three,service_tax_paydirect_one:window.environment.service_tax_paydirect_one,service_tax_paydirect_two:window.environment.service_tax_paydirect_two,service_tax_paydirect_three:window.environment.service_tax_paydirect_three,service_tax_paypal_one:window.environment.service_tax_paypal_one,service_tax_paypal_two:window.environment.service_tax_paypal_two,service_tax_paypal_three:window.environment.service_tax_paypal_three,service_tax_creditcard_one:window.environment.service_tax_creditcard_one,service_tax_creditcard_two:window.environment.service_tax_creditcard_two,service_tax_creditcard_three:window.environment.service_tax_creditcard_three,redeemedAmountPayment:window.environment.redeemedAmountPayment,moneyBalancePayment:window.environment.moneyBalancePayment,serviceFeePayment:window.environment.serviceFeePayment,amountPayment:window.environment.amountPayment}}function t(t,a){a=a||"";var o=0;return"payByBill"===a?(t<=30&&(o=e().service_tax_paybybill_one),t>30&&t<=100&&(o=e().service_tax_paybybill_two),t>100&&(o=e().service_tax_paybybill_three)):"sofort"===a?(t<=30&&(o=e().service_tax_sofort_one),t>30&&t<=100&&(o=e().service_tax_sofort_two),t>100&&(o=e().service_tax_sofort_three)):"payDirect"===a?(t<=30&&(o=e().service_tax_paydirect_one),t>30&&t<=100&&(o=e().service_tax_paydirect_two),t>100&&(o=e().service_tax_paydirect_three)):"payPal"===a?(t<=30&&(o=e().service_tax_paypal_one),t>30&&t<=100&&(o=e().service_tax_paypal_two),t>100&&(o=e().service_tax_paypal_three)):"creditCard"===a?(t<=30&&(o=e().service_tax_creditcard_one),t>30&&t<=100&&(o=e().service_tax_creditcard_two),t>100&&(o=e().service_tax_creditcard_three)):(t<=30&&(o=e().tax_one),t>30&&t<=100&&(o=e().tax_two),t>100&&(o=e().tax_three)),o}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var a=new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",minimumFractionDigits:2}),o=$(".sumPrepayAmount").data("sumprepayamount");$(".moneyBalanceCheckbox").click(function(){if($(this).is(":checked")){$(".afterRedeem").show();var n=$(this).parents().eq(2).data("redeem"),r=$(".sumPrepayAmount").data("sumprepayamount");if(n>=r){var i=n-r;$(".redeemAmount").html('<p class="info-listing-booking2">'+e().redeemedAmountPayment+':</p><p class="info-listing-price-booking2">'+a.format(n)+"</p>"),$(".moneyBalance").html('<p class="info-listing-booking2">'+e().moneyBalancePayment+':</p><p class="info-listing-price-booking2">'+a.format(i)+"</p>"),$(".afterRedeemAmount").html(),$(".sumPrepayServiceTotal").html(),$(".serviceFee").hide(),$(".totalPrepayAmount").hide()}else{$(".serviceFee").show();var i=r-n,s=$(".serviceFee").attr("data-paymentmethod"),l=t(i,s);o=i;var d=l/100*i,c=i+d;$(".redeemAmount").html('<p class="info-listing-booking2">'+e().redeemedAmountPayment+':</p><p class="info-listing-price-booking2">'+a.format(n)+"</p>"),$(".moneyBalance").html(),$(".afterRedeemAmount").html('<p class="info-listing-booking2">'+e().amountPayment+':</p><p class="info-listing-price-booking2">'+a.format(i)+"</p>"),$(".sumPrepayServiceTotal").html(a.format(c)),$(".serviceFee").html('<p class="info-listing-booking2">'+e().serviceFeePayment+':</p><p class="info-listing-price-booking2">'+l+" %</p>"),$(".totalPrepayAmount").show()}}else{$(".afterRedeem").hide(),$(".serviceFee").show();var m=$(".sumPrepayAmount").data("sumprepayamount"),s=$(".serviceFee").attr("data-paymentmethod"),p=t(m,s);o=m;var u=p/100*m,h=m+u;$(".sumPrepayServiceTotal").html(a.format(h)),$(".serviceFee").html('<p class="info-listing-booking2">'+e().serviceFeePayment+':</p><p class="info-listing-price-booking2">'+p+" %</p>"),$(".totalPrepayAmount").show()}}),$("input[name='payment']").on("click",function(){$(".serviceFee").attr("data-paymentmethod",$(this).val()),"creditCard"===$(this).val()?$("#creditcard").show():$("#creditcard").hide();var n=t(o,$(this).val()),r=n/100*o,i=o+r;$(".serviceFee").html('<p class="info-listing-booking2">'+e().serviceFeePayment+':</p><p class="info-listing-price-booking2">'+n+" %</p>"),$(".sumPrepayServiceTotal").html(a.format(i))})}),$(function(){function e(e){var t=e.split(".");return new Date("20"+t[2],t[1]-1,t[0])}function t(e){var t=$(".daysEditBook").data("prepaymentamount"),a=$(".daysEditBook").data("cabinprepaymentamount"),n=$(".daysEditBook").data("sleepingplace"),r=0;if(1!==n){var i=0,s=0;""!==$(".jsEditBookBed").val()&&(s=$(".jsEditBookBed").val()),""!==$(".jsEditBookDorm").val()&&(i=$(".jsEditBookDorm").val()),r=parseInt(s)+parseInt(i)}else{var l=0;""!==$(".jsEditBookSleep").val()&&(l=$(".jsEditBookSleep").val())}var d=1===n?l:r,c=a*e*d,m=c>t?c-t:c;$(".replaceEditBookingGuest").html(d),o(m,t,c)}function a(){return n={confirmDeleteBooking:window.environment.confirmDeleteBooking,deleteFailed:window.environment.deleteFailed,cancelBookingMoneyReturnConfirm:window.environment.cancelBookingMoneyReturnConfirm,cancelBookingMoneyNotReturnConfirm:window.environment.cancelBookingMoneyNotReturnConfirm}}function o(e,t,a){var o={tax_one_for_edit_booking:window.environment.service_tax_one_for_edit_booking,tax_two_for_edit_booking:window.environment.service_tax_two_for_edit_booking,tax_three_for_edit_booking:window.environment.service_tax_three_for_edit_booking},n="";e<=30&&(n=o.tax_one_for_edit_booking),e>30&&e<=100&&(n=o.tax_two_for_edit_booking),e>100&&(n=o.tax_three_for_edit_booking);var i=n/100*e,s=e+i;a>t?($(".amountGreater").show(),$(".voucherGreater").hide(),$(".replaceEditBookingCompleteDeposit").html(r.format(e)),$(".replaceEditBookingServiceFee").html(n+" %"),$(".replaceEditBookingCompletePayment").html(r.format(s))):($(".voucherGreater").show(),$(".amountGreater").hide(),$(".replaceEditBookingCompleteDeposit").html(r.format(e)),$(".replaceEditBookingToWallet").html(r.format(t-e)))}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("body").on("mousedown",".dateFromEditBook",function(){var a=$(this).parent().parent().data("id"),o=$("#dateFromEditBook_"+a),n=[],r=$(".holidayEditBook_"+a).data("holiday"),i=$(".greenEditBook_"+a).data("green"),s=$(".orangeEditBook_"+a).data("orange"),l=$(".redEditBook_"+a).data("red"),d=$(".notSeasonTimeEditBook_"+a).data("notseasontime"),c="";o.datepicker({showAnim:"drop",dateFormat:"dd.mm.y",changeMonth:!0,changeYear:!0,monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],minDate:"+1d",yearRange:"0:+2"}),o.datepicker("option","onSelect",function(n){var r=$("#dateToEditBook_"+a),i=o.datepicker("getDate"),s=o.datepicker("getDate");r.datepicker("setDate",s),i.setDate(i.getDate()+60),s.setDate(s.getDate()+1),r.datepicker("option","maxDate",i),r.datepicker("option","minDate",s);var l=e(n),d=e(r.val()),c=Math.abs(d.getTime()-l.getTime()),m=Math.ceil(Math.round(c/864e5));if(l<d){$(".daysEditBook").attr("data-days",m),$(".replaceNumberOfNights").html(m+" Tag(e)");t($(".daysEditBook").attr("data-days"))}}),o.datepicker("option","onChangeMonthYear",function(e,t,n){void 0!=e&&void 0!=t&&(c=e+"-",c+=t+"-",c+="01"),$.ajax({url:"/calendar/ajax",dataType:"JSON",type:"POST",data:{dateFrom:c,dataId:a},success:function(e){for(var t=0;t<e.holidayDates.length;t++)r.push(e.holidayDates[t]);for(var t=0;t<e.greenDates.length;t++)i.push(e.greenDates[t]);for(var t=0;t<e.orangeDates.length;t++)s.push(e.orangeDates[t]);for(var t=0;t<e.redDates.length;t++)l.push(e.redDates[t]);for(var t=0;t<e.not_season_time.length;t++)d.push(e.not_season_time[t]);o.datepicker("refresh")}})}),o.datepicker("option","beforeShowDay",function(e){var t=jQuery.datepicker.formatDate("yy-mm-dd",e);return i.indexOf(t)>=0&&(n=[!0,"greenDates","Verfügbar"]),s.indexOf(t)>=0&&(n=[!0,"orangeDates","Begrenzt"]),l.indexOf(t)>=0&&(n=[!0,"redDates","Ausgebucht"]),d.indexOf(t)>=0&&(n=[!1,"","Geschlossen"]),r.indexOf(t)>=0&&(n=[!1,"","Ruhetag"]),n}),o.datepicker("show")}),$("body").on("mousedown",".dateToEditBook",function(){var a=$(this).parent().parent().data("id"),o=$("#dateToEditBook_"+a),n=[],r=$(".holidayEditBook_"+a).data("holiday"),i=$(".greenEditBook_"+a).data("green"),s=$(".orangeEditBook_"+a).data("orange"),l=$(".redEditBook_"+a).data("red"),d=$(".notSeasonTimeEditBook_"+a).data("notseasontime"),c="";o.datepicker({showAnim:"drop",dateFormat:"dd.mm.y",changeMonth:!0,changeYear:!0,monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],yearRange:"0:+2"}),o.datepicker("option","onSelect",function(o){var n=$("#dateFromEditBook_"+a),r=e(n.val()),i=e(o),s=Math.abs(i.getTime()-r.getTime()),l=Math.ceil(Math.round(s/864e5));if(r<i){$(".daysEditBook").attr("data-days",l),$(".replaceNumberOfNights").html(l+" Tag(e)");t($(".daysEditBook").attr("data-days"))}}),o.datepicker("option","onChangeMonthYear",function(e,t,n){void 0!=e&&void 0!=t&&(c=e+"-",c+=t+"-",c+="01"),$.ajax({url:"/calendar/ajax",dataType:"JSON",type:"POST",data:{dateFrom:c,dataId:a},success:function(e){for(var t=0;t<e.holidayDates.length;t++)r.push(e.holidayDates[t]);for(var t=0;t<e.greenDates.length;t++)i.push(e.greenDates[t]);for(var t=0;t<e.orangeDates.length;t++)s.push(e.orangeDates[t]);for(var t=0;t<e.redDates.length;t++)l.push(e.redDates[t]);for(var t=0;t<e.not_season_time.length;t++)d.push(e.not_season_time[t]);o.datepicker("refresh")}})}),o.datepicker("option","beforeShowDay",function(e){var t=jQuery.datepicker.formatDate("yy-mm-dd",e);return i.indexOf(t)>=0&&(n=[!0,"greenDates","Verfügbar"]),s.indexOf(t)>=0&&(n=[!0,"orangeDates","Begrenzt"]),l.indexOf(t)>=0&&(n=[!0,"redDates","Ausgebucht"]),r.indexOf(t)>=0&&(n=[!0,"holidayDates","Ruhetag"]),d.indexOf(t)>=0&&(n=[!1,"","Geschlossen"]),n}),o.datepicker("show")});$("#update_book_comment").css("color","red"),$("#update_book_comment").html("noch 300 Zeichen"),$("#comments").keyup(function(){var e=$("#comments").val().length,t=300-e;$("#update_book_comment").html("noch "+t+" Zeichen")});var n="";$(".deleteCancelledBookingHistory").on("click",function(e){e.preventDefault();var t=$(this).data("del"),o=$(this).btnBootstrap("loading");!0===confirm(a().confirmDeleteBooking)?$.ajax({url:"/booking/history/delete/cancelled/booking",dataType:"JSON",type:"POST",data:{delId:t}}).done(function(e){"success"===e.status?(o.btnBootstrap("reset"),window.location.href="/booking/history/"):$(".responseMessage").html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>OOPS! </strong>'+a().deleteFailed+"</div>")}).fail(function(){o.btnBootstrap("reset"),$(".responseMessage").html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>OOPS! </strong>'+a().deleteFailed+"</div>")}):o.btnBootstrap("reset")}),$(".deleteWaitingPrepaymentBookingHistory").on("click",function(e){e.preventDefault();var t=$(this).data("delwaitingprepay"),o=$(this).btnBootstrap("loading");!0===confirm(a().confirmDeleteBooking)?$.ajax({url:"/booking/history/delete/waiting/prepay",dataType:"JSON",type:"POST",data:{delId:t}}).done(function(e){"success"===e.status?(o.btnBootstrap("reset"),window.location.href="/booking/history/"):$(".responseMessage").html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>OOPS! </strong>'+a().deleteFailed+"</div>")}).fail(function(){o.btnBootstrap("reset"),$(".responseMessage").html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>OOPS! </strong>'+a().deleteFailed+"</div>")}):o.btnBootstrap("reset")}),$(".deleteInquiryApprovedBookingHistory").on("click",function(e){e.preventDefault();var t=$(this).data("delapprovedinquiry"),o=$(this).btnBootstrap("loading");!0===confirm(a().confirmDeleteBooking)?$.ajax({url:"/booking/history/delete/approved/inquiry",dataType:"JSON",type:"POST",data:{delId:t}}).done(function(e){"success"===e.status?(o.btnBootstrap("reset"),window.location.href="/booking/history/"):$(".responseMessage").html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>OOPS! </strong>'+a().deleteFailed+"</div>")}).fail(function(){o.btnBootstrap("reset"),$(".responseMessage").html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>OOPS! </strong>'+a().deleteFailed+"</div>")}):o.btnBootstrap("reset")}),$(".deleteInquiryWaitingBookingHistory").on("click",function(e){e.preventDefault();var t=$(this).data("delwaitinginquiry"),o=$(this).btnBootstrap("loading");!0===confirm(a().confirmDeleteBooking)?$.ajax({url:"/booking/history/delete/waiting/inquiry",dataType:"JSON",type:"POST",data:{delId:t}}).done(function(e){"success"===e.status?(o.btnBootstrap("reset"),window.location.href="/booking/history/"):$(".responseMessage").html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>Whoops! </strong>'+a().deleteFailed+"</div>")}).fail(function(){o.btnBootstrap("reset"),$(".responseMessage").html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>Whoops! </strong>'+a().deleteFailed+"</div>")}):o.btnBootstrap("reset")}),$(".deleteInquiryRejectedBookingHistory").on("click",function(e){e.preventDefault();var t=$(this).data("delrejectedinquiry"),o=$(this).btnBootstrap("loading");!0===confirm(a().confirmDeleteBooking)?$.ajax({url:"/booking/history/delete/rejected/inquiry",dataType:"JSON",type:"POST",data:{delId:t}}).done(function(e){"success"===e.status?(o.btnBootstrap("reset"),window.location.href="/booking/history/"):$(".responseMessage").html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>OOPS! </strong>'+a().deleteFailed+"</div>")}).fail(function(){o.btnBootstrap("reset"),$(".responseMessage").html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>OOPS! </strong>'+a().deleteFailed+"</div>")}):o.btnBootstrap("reset")}),$(".cancelMoneyReturn").on("click",function(e){e.preventDefault();var t=$(this).data("cancel"),o=$(this).data("return"),n=$(this).btnBootstrap("loading"),r="";r="yes"===o?confirm(a().cancelBookingMoneyReturnConfirm):confirm(a().cancelBookingMoneyNotReturnConfirm),!0===r?$.ajax({url:"/booking/history/cancel",dataType:"JSON",type:"POST",data:{cancelId:t}}).done(function(e){"success"===e.status?(n.btnBootstrap("reset"),window.location.href="/booking/history/"):$(".responseCancelMessage_"+t).html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>OOPS! </strong>'+a().deleteFailed+"</div>")}).fail(function(){n.btnBootstrap("reset"),$(".responseCancelMessage_"+t).html('<div class="alert alert-warning alert-dismissible response" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>OOPS! </strong>'+a().deleteFailed+"</div>")}):n.btnBootstrap("reset")});var r=new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",minimumFractionDigits:2});$(".jsEditBookSleep").change(function(){var e=$(".daysEditBook").attr("data-days"),t=$(".daysEditBook").data("prepaymentamount"),a=$(".daysEditBook").data("cabinprepaymentamount"),n=0;""!==$(this).val()&&(n=$(this).val());var r=a*e*n,i=r>t?r-t:r;$(".replaceEditBookingGuest").html(n),o(i,t,r)}),$(".jsEditBookBed").change(function(){var e=$(".daysEditBook").attr("data-days"),t=$(".daysEditBook").data("prepaymentamount"),a=$(".daysEditBook").data("cabinprepaymentamount"),n=0,r=0;""!==$(this).val()&&(r=$(this).val()),""!==$(".jsEditBookDorm").val()&&(n=$(".jsEditBookDorm").val());var i=parseInt(r)+parseInt(n),s=a*e*i,l=s>t?s-t:s;$(".replaceEditBookingGuest").html(i),o(l,t,s)}),$(".jsEditBookDorm").change(function(){var e=$(".daysEditBook").attr("data-days"),t=$(".daysEditBook").data("prepaymentamount"),a=$(".daysEditBook").data("cabinprepaymentamount"),n=0,r=0;""!==$(this).val()&&(n=$(this).val()),""!==$(".jsEditBookBed").val()&&(r=$(".jsEditBookBed").val());var i=parseInt(n)+parseInt(r),s=a*e*i,l=s>t?s-t:s;$(".replaceEditBookingGuest").html(i),o(l,t,s)}),$(".sendChatMsg").on("click",function(e){e.preventDefault();var t=$(this).data("chatbookid"),a=$(this).btnBootstrap("loading"),o=$(".chatMessage_"+t).val();""!==t&&$.ajax({url:"/booking/history/inquiry/message/send",dataType:"JSON",type:"POST",data:{chatBookId:t,message:o}}).done(function(e){"success"===e.status&&(a.btnBootstrap("reset"),$(".hideAfterSuccess").hide(),$(".successMessage_"+t).html('<div class="alert alert-success alert-dismissible"> <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button> <h4><i class="icon fa fa-check"></i></h4>Die Nachricht wurde nun versendet</div>'),setInterval(function(){window.location.href="/booking/history/"},1e3))}).fail(function(e){if(a.btnBootstrap("reset"),422===e.status){var o=e.responseJSON.errors;if(o)$("#chatSendFailed_"+t).hide(),$("#errorSendFailed_"+t).show(),errorsHtml='<div class="alert alert-danger"><ul>',$.each(o,function(e,t){errorsHtml+="<li>"+t+"</li>"}),errorsHtml+="</ul></div>",$("#errorSendFailed_"+t).html(errorsHtml);else{$("#errorSendFailed_"+t).hide(),$("#chatSendFailed_"+t).show();var n=e.responseJSON;errorsHtml='<div class="alert alert-info"><ul>',$.each(n,function(e,t){errorsHtml+="<li>"+t+"</li>"}),errorsHtml+="</ul></div>",$("#chatSendFailed_"+t).html(errorsHtml)}}})})});